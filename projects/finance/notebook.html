<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ML Trading Signal Notebook</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: system-ui, -apple-system, sans-serif; background: #f6f8fa; }
        .nb-container { max-width: 100%; height: 100vh; overflow: auto; }
        .nb-header { background: #24292f; color: white; padding: 12px 20px; position: sticky; top: 0; z-index: 100; display: flex; justify-content: space-between; align-items: center; }
        .nb-header h1 { font-size: 16px; font-weight: 500; }
        .nb-header a { color: #58a6ff; text-decoration: none; font-size: 14px; }
        .nb-header a:hover { text-decoration: underline; }
        .nb-content { padding: 20px; max-width: 1000px; margin: 0 auto; }
        .nb-cell { background: white; border: 1px solid #d0d7de; border-radius: 6px; margin-bottom: 16px; overflow: hidden; }
        .nb-md { padding: 16px 20px; }
        .nb-md h1 { font-size: 1.5em; color: #24292f; border-bottom: 1px solid #d0d7de; padding-bottom: 8px; margin-bottom: 12px; }
        .nb-md h2 { font-size: 1.25em; color: #24292f; margin: 16px 0 8px; }
        .nb-md h3 { font-size: 1.1em; color: #24292f; margin: 12px 0 6px; }
        .nb-md p { color: #24292f; line-height: 1.6; margin: 8px 0; font-size: 14px; }
        .nb-md ul { margin: 8px 0; padding-left: 24px; }
        .nb-md li { color: #24292f; line-height: 1.6; margin: 4px 0; font-size: 14px; }
        .nb-md strong { font-weight: 600; }
        .nb-md code { background: #f6f8fa; padding: 2px 6px; border-radius: 3px; font-size: 13px; }
        .nb-code { border-left: 3px solid #0969da; }
        .nb-in { background: #f6f8fa; padding: 4px 12px; font-size: 12px; color: #57606a; border-bottom: 1px solid #d0d7de; font-family: monospace; cursor: pointer; display: flex; align-items: center; }
        .nb-in:hover { background: #eaeef2; }
        .nb-in .arrow { margin-right: 8px; transition: transform 0.2s; font-size: 10px; }
        .nb-in.collapsed .arrow { transform: rotate(-90deg); }
        .nb-source { background: #0d1117; color: #c9d1d9; padding: 12px 16px; font-family: 'Monaco', 'Menlo', monospace; font-size: 13px; overflow-x: auto; white-space: pre; max-height: 400px; overflow-y: auto; }
        .nb-source.hidden { display: none; }
        .nb-out { padding: 12px 16px; background: #fff; border-top: 1px solid #d0d7de; overflow-x: auto; }
        .nb-out img { max-width: 100%; height: auto; display: block; margin: 8px auto; }
        .nb-out pre { font-family: monospace; font-size: 12px; color: #24292f; white-space: pre-wrap; max-height: 300px; overflow-y: auto; }
        .nb-out table { border-collapse: collapse; font-size: 12px; margin: 8px 0; }
        .nb-out th, .nb-out td { border: 1px solid #d0d7de; padding: 6px 10px; text-align: left; }
        .nb-out th { background: #f6f8fa; font-weight: 600; }
    </style>
</head>
<body>
    <div class="nb-container">
        <div class="nb-header">
            <h1>ðŸ““ ml_trading_signal.ipynb</h1>
            <a href="https://github.com/rodrigueza81/rodrigueza81.github.io/blob/main/projects/finance/ml_trading_signal.ipynb" target="_blank">View on GitHub â†’</a>
        </div>
        <div class="nb-content" id="notebook"></div>
    </div>
    <script>
        fetch('ml_trading_signal.ipynb')
            .then(r => r.json())
            .then(nb => {
                const container = document.getElementById('notebook');
                let cellNum = 0;
                nb.cells.forEach((cell, idx) => {
                    const div = document.createElement('div');
                    div.className = 'nb-cell' + (cell.cell_type === 'code' ? ' nb-code' : '');
                    
                    if (cell.cell_type === 'markdown') {
                        div.classList.add('nb-md');
                        let html = cell.source.join('');
                        html = html.replace(/^### (.+)$/gm, '<h3>$1</h3>');
                        html = html.replace(/^## (.+)$/gm, '<h2>$1</h2>');
                        html = html.replace(/^# (.+)$/gm, '<h1>$1</h1>');
                        html = html.replace(/\*\*(.+?)\*\*/g, '<strong>$1</strong>');
                        html = html.replace(/`([^`]+)`/g, '<code>$1</code>');
                        html = html.replace(/^- (.+)$/gm, '<li>$1</li>');
                        html = html.replace(/(<li>.*<\/li>)/s, '<ul>$1</ul>');
                        html = html.replace(/\n\n/g, '</p><p>');
                        html = '<p>' + html + '</p>';
                        html = html.replace(/<p>\s*<h/g, '<h').replace(/<\/h(\d)>\s*<\/p>/g, '</h$1>');
                        html = html.replace(/<p>\s*<ul>/g, '<ul>').replace(/<\/ul>\s*<\/p>/g, '</ul>');
                        html = html.replace(/<p>\s*<\/p>/g, '');
                        div.innerHTML = html;
                    } else if (cell.cell_type === 'code') {
                        cellNum++;
                        const inDiv = document.createElement('div');
                        inDiv.className = 'nb-in';
                        inDiv.innerHTML = '<span class="arrow">â–¼</span> In [' + cellNum + ']:';
                        inDiv.onclick = function() {
                            this.classList.toggle('collapsed');
                            this.nextElementSibling.classList.toggle('hidden');
                        };
                        div.appendChild(inDiv);
                        
                        const srcDiv = document.createElement('div');
                        srcDiv.className = 'nb-source';
                        srcDiv.textContent = cell.source.join('');
                        div.appendChild(srcDiv);
                        
                        if (cell.outputs && cell.outputs.length > 0) {
                            const outDiv = document.createElement('div');
                            outDiv.className = 'nb-out';
                            cell.outputs.forEach(out => {
                                if (out.text) {
                                    const pre = document.createElement('pre');
                                    pre.textContent = out.text.join('');
                                    outDiv.appendChild(pre);
                                } else if (out.data) {
                                    if (out.data['image/png']) {
                                        const img = document.createElement('img');
                                        img.src = 'data:image/png;base64,' + out.data['image/png'];
                                        outDiv.appendChild(img);
                                    } else if (out.data['text/html']) {
                                        const htmlDiv = document.createElement('div');
                                        htmlDiv.innerHTML = out.data['text/html'].join('');
                                        outDiv.appendChild(htmlDiv);
                                    } else if (out.data['text/plain']) {
                                        const pre = document.createElement('pre');
                                        pre.textContent = out.data['text/plain'].join('');
                                        outDiv.appendChild(pre);
                                    }
                                }
                            });
                            div.appendChild(outDiv);
                        }
                    }
                    container.appendChild(div);
                });
            });
    </script>
</body>
</html>
